---
# tasks file for prod
- name: add docker file
  copy:
    src: Dockerfile
    dest: /tmp

- name: build container image
  docker_image:
    name: tomcat
    build:
      path: /tmp
    state: present

- name: Pip install docker
  pip:
    name: docker

- name: Create a volume
  community.docker.docker_volume:
    name: volume

- name: Start a conteiner build
  community.docker.docker_container:
    name: build
    state: started
    image: syrkashevav/build:v1.0
    volumes:
      - volume:/workdir

- name: Start a conteiner tomcat
  community.docker.docker_container:
    name: tomcat
    state: started
    image: tomcat
    volumes:
      - volume:/usr/local/tomcat/webapps/
    ports: 8081:8080

- name: Stop a container build
  community.docker.docker_container:
    name: build
    state: stopped

- name: Remove a container build
  community.docker.docker_container:
    name: build
    state: absent

- name: Remove an image on Docker Hub
  community.docker.docker_image:
    name: syrkashevav/build
    tag: v1.0
    state: absent
